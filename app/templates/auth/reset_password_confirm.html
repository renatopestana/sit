{% extends "base.html" %}
{% block content %}

<div class="max-w-md mx-auto">
  <div class="bg-base-200 text-base-content rounded-xl p-6 md:p-8 shadow">
    <form method="post" novalidate>
      {{ form.hidden_tag() }}

      <h3 class="text-xl font-semibold mb-6">Definir nova senha</h3>

      <!-- Nova senha -->
      <div class="form-control w-full">
        {{ form.password.label(class="label") }}
        <div class="relative">
          {{ form.password(class="input input-bordered w-full pr-12") }}
          <button type="button"
                  class="btn btn-ghost btn-xs absolute right-2 top-2"
                  onclick="togglePwd('password')">ver</button>
        </div>
        {% if form.password.errors %}
          <label class="label">
            <span class="label-text-alt text-error">{{ '; '.join(form.password.errors) }}</span>
          </label>
        {% endif %}
      </div>

      <!-- Confirmar nova senha -->
      <div class="form-control w-full mt-4">
        {{ form.confirm_password.label(class="label") }}
        <div class="relative">
          {{ form.confirm_password(class="input input-bordered w-full pr-12") }}
          <button type="button"
                  class="btn btn-ghost btn-xs absolute right-2 top-2"
                  onclick="togglePwd('confirm_password')">ver</button>
        </div>
        {% if form.confirm_password.errors %}
          <label class="label">
            <span class="label-text-alt text-error">{{ '; '.join(form.confirm_password.errors) }}</span>
          </label>
        {% endif %}
      </div>

      <!-- Ações -->
      <div class="mt-6 flex items-center gap-3">
        {% if form.submit is defined %}
          {{ form.submit(class="btn btn-primary") }}
        {% else %}
          <button type="submit" class="btn btn-primary">Salvar nova senha</button>
        {% endif %}
        {{ url_for(Voltar ao login</a>
      </div>
    </form>
  </div>
</div>

<script>
  function togglePwd(fieldName) {
    const el = document.getElementsByName(fieldName)[0];
    if (!el) return;
    el.type = (el.type === 'password') ? 'text' : 'password';
  }
</script>

{% endblock %}